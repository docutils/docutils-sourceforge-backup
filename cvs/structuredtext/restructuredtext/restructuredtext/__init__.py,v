head	1.12;
access;
symbols
	RELEASE:1.1.1.1
	Rrefactor-test:1.1.1.1.0.4
	rel-0-3:1.1.1.1.0.2
	open:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2002.03.28.04.28.10;	author goodger;	state Exp;
branches;
next	1.11;

1.11
date	2002.03.11.03.22.15;	author goodger;	state Exp;
branches;
next	1.10;

1.10
date	2002.02.06.02.26.52;	author goodger;	state Exp;
branches;
next	1.9;

1.9
date	2002.01.30.05.01.05;	author goodger;	state Exp;
branches;
next	1.8;

1.8
date	2002.01.16.06.19.04;	author goodger;	state Exp;
branches;
next	1.7;

1.7
date	2001.09.10.04.42.28;	author goodger;	state Exp;
branches;
next	1.6;

1.6
date	2001.09.07.01.23.07;	author goodger;	state Exp;
branches;
next	1.5;

1.5
date	2001.09.01.15.49.28;	author goodger;	state Exp;
branches;
next	1.4;

1.4
date	2001.08.25.02.02.27;	author goodger;	state Exp;
branches;
next	1.3;

1.3
date	2001.08.22.03.16.46;	author goodger;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.01.02.54.37;	author goodger;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.21.22.14.04;	author goodger;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.21.22.14.04;	author goodger;	state Exp;
branches;
next	;


desc
@@


1.12
log
@*** empty log message ***
@
text
@#! /usr/bin/env python

"""
:Author: David Goodger
:Contact: goodger@@users.sourceforge.net
:Revision: $Revision: 1.11 $
:Date: $Date: 2002/03/11 03:22:15 $
:Copyright: This module has been placed in the public domain.

This is ``the dps.parsers.restructuredtext`` package. It exports a single
class, `Parser`.

Usage
=====

1. Create a parser::

       parser = dps.parsers.restructuredtext.Parser()

   Several optional arguments may be passed to modify the parser's behavior.
   Please see `dps.parsers.Parser` for details.

2. Gather input (a multi-line string), by reading a file or the standard
   input::

       input = sys.stdin.read()

3. Create a new empty `dps.nodes.document` tree::

       docroot = dps.utils.newdocument()

   See `dps.utils.newdocument()` for parameter details.

4. Run the parser, populating the document tree::

       document = parser.parse(input, docroot)

Parser Overview
===============

The reStructuredText parser is implemented as a state machine, examining its
input one line at a time. To understand how the parser works, please first
become familiar with the `dps.statemachine` module, then see the
`states` module.
"""

__docformat__ = 'reStructuredText'

__all__ = ['Parser']

import dps.parsers
import dps.statemachine
import states


class Parser(dps.parsers.Parser):

    """The reStructuredText parser."""

    def parse(self, inputstring, docroot):
        """Parse `inputstring` and populate `docroot`, a document tree."""
        self.setup_parse(inputstring, docroot)
        debug = docroot.reporter[''].debug
        self.statemachine = states.RSTStateMachine(
              stateclasses=states.stateclasses, initialstate='Body',
              debug=debug)
        inputlines = dps.statemachine.string2lines(
              inputstring, convertwhitespace=1)
        self.statemachine.run(inputlines, docroot)
@


1.11
log
@updated
@
text
@d6 2
a7 2
:Revision: $Revision: 1.10 $
:Date: $Date: 2002/02/06 02:26:52 $
d62 1
a66 1
        self.setup_parse(inputstring, docroot)
@


1.10
log
@updated
@
text
@d6 2
a7 2
:Revision: $Revision: 1.9 $
:Date: $Date: 2002/01/30 05:01:05 $
d62 1
a62 1
        debug = docroot.reporter.getcategory('')[0] # default debug priority
@


1.9
log
@  - Updated for new document Node creation protocol.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.8 $
:Date: $Date: 2002/01/16 06:19:04 $
d47 4
a54 2
__all__ = ['Parser']

d60 3
a62 2
    def __init__(self, debug=0):
        dps.parsers.Parser.__init__(self, debug=0)
d65 1
a65 4
              debug=self.debug)

    def parse(self, inputstring, docroot):
        """Parse `inputstring` and populate `docroot`, a document tree."""
d67 2
a68 2
        inputlines = dps.statemachine.string2lines(self.inputstring,
                                                   convertwhitespace=1)
@


1.8
log
@updated for languagecode
@
text
@d6 2
a7 2
:Revision: $Revision: 1.7 $
:Date: $Date: 2001/09/10 04:42:28 $
d21 1
a21 1
   Please see `dps.parsers.model.Parser` for details.
d28 1
a28 1
3. Run the parser, generating a `dps.nodes.document` tree::
d30 7
a36 1
       document = parser.parse(input)
d47 1
a47 1
import dps.parsers.model
d54 1
a54 1
class Parser(dps.parsers.model.Parser):
d58 2
a59 2
    def __init__(self, *args, **keywordargs):
        dps.parsers.model.Parser.__init__(self, *args, **keywordargs)
d62 1
a62 1
              languagecode=self.languagecode, debug=self.debug)
d64 3
a66 3
    def parse(self, inputstring):
        """Parse `inputstring` and return a `dps.nodes.document` tree."""
        self.setup_parse(inputstring)
d69 1
a69 4
        document = self.statemachine.run(inputlines,
                                         warninglevel=self.warninglevel,
                                         errorlevel=self.errorlevel)
        return document
@


1.7
log
@  - Added parser language module support.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.6 $
:Date: $Date: 2001/09/07 01:23:07 $
d43 1
a43 1
import states, languages
a53 1
        self.language = languages.language(self.languagecode)
d56 1
a56 1
              language=self.language, debug=self.debug)
@


1.6
log
@  - Moved Parser.statemachine into __init__ to use language module.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.5 $
:Date: $Date: 2001/09/01 15:49:28 $
d43 1
a43 1
import states
d54 1
@


1.5
log
@  - Added a shared ``Parser.statemachine`` class attribute.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.3 $
:Date: $Date: 2001/08/22 03:16:46 $
d52 5
a56 2
    statemachine = states.RSTStateMachine(stateclasses=states.stateclasses,
                                          initialstate='Body')
@


1.4
log
@  - Added form feed & vertical tab conversion to spaces.
@
text
@d52 3
a57 2
        sm = states.RSTStateMachine(stateclasses=states.stateclasses,
                                    initialstate='Body')
d60 3
a62 3
        document = sm.run(inputlines, warninglevel=self.warninglevel,
                          errorlevel=self.errorlevel)
        sm.unlink()
@


1.3
log
@  - Changed biblio field format; contact email.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.2 $
:Date: $Date: 2001/08/01 02:54:37 $
d57 2
a58 1
        inputlines = dps.statemachine.string2lines(self.inputstring)
@


1.2
log
@added docstrings; modified Parser.parse() for updated RSTStateMachine and dps.parsers.model
@
text
@d4 5
a8 5
Author: David Goodger
Contact: dgoodger@@bigfoot.com
Revision: $Revision: 1.1.1.1 $
Date: $Date: 2001/07/21 22:14:04 $
Copyright: This module has been placed in the public domain.
@


1.1
log
@Initial revision
@
text
@d6 2
a7 2
Revision: $Revision: 1.3 $
Date: $Date: 2001/07/20 00:33:15 $
d10 29
d41 2
a42 2
from dps.parsers import model
from dps.statemachine import string2lines
d48 3
a50 1
class Parser(model.Parser):
d53 2
a54 1
        model.Parser.parse(self, inputstring)
d57 3
a59 3
        inputlines = string2lines(self.inputstring)
        sm.run(inputlines, warninglevel=self.warninglevel,
               errorlevel=self.errorlevel)
d61 1
a61 1
        return sm.memo.document
@


1.1.1.1
log
@initial checkin
@
text
@@
