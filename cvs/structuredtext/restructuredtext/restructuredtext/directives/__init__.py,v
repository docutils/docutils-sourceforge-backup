head	1.9;
access;
symbols
	RELEASE:1.1.1.1
	Rrefactor-test:1.1.1.1.0.4
	rel-0-3:1.1.1.1.0.2
	open:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2002.03.16.05.41.36;	author goodger;	state Exp;
branches;
next	1.8;

1.8
date	2002.03.07.03.27.49;	author goodger;	state Exp;
branches;
next	1.7;

1.7
date	2002.02.12.02.29.02;	author goodger;	state Exp;
branches;
next	1.6;

1.6
date	2001.11.06.00.53.24;	author goodger;	state Exp;
branches;
next	1.5;

1.5
date	2001.09.13.02.20.34;	author goodger;	state Exp;
branches;
next	1.4;

1.4
date	2001.09.12.04.02.18;	author goodger;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.10.04.40.06;	author goodger;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.23.04.11.57;	author goodger;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.21.22.14.13;	author goodger;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.07.21.22.14.13;	author goodger;	state Exp;
branches;
next	;


desc
@@


1.9
log
@docstring
@
text
@#! /usr/bin/env python

"""
:Author: David Goodger
:Contact: goodger@@users.sourceforge.net
:Revision: $Revision: 1.8 $
:Date: $Date: 2002/03/07 03:27:49 $
:Copyright: This module has been placed in the public domain.

This package contains directive implementation modules.

The interface for directive functions is as follows::

    def directivefn(match, type, data, state, statemachine, attributes)

Where:

- ``match`` is a regular expression match object which matched the first line
  of the directive. ``match.group(1)`` gives the directive name.
- ``type`` is the directive type or name.
- ``data`` contains the remainder of the first line of the directive after the
  "::".
- ``state`` is the state which called the directive function.
- ``statemachine`` is the state machine which controls the state which called
  the directive function.
- ``attributes`` is a dictionary of extra attributes which may be added to the
  element the directive produces. Currently, only an "alt" attribute is passed
  by substitution definitions (value: the substitution name), which may by
  used by an embedded image directive.
"""

__docformat__ = 'reStructuredText'

__all__ = ['directive']


_directive_registry = {
      'attention': ('admonitions', 'attention'),
      'caution': ('admonitions', 'caution'),
      'danger': ('admonitions', 'danger'),
      'error': ('admonitions', 'error'),
      'important': ('admonitions', 'important'),
      'note': ('admonitions', 'note'),
      'tip': ('admonitions', 'tip'),
      'hint': ('admonitions', 'hint'),
      'warning': ('admonitions', 'warning'),
      'image': ('images', 'image'),
      'figure': ('images', 'figure'),
      'contents': ('components', 'contents'),
      'footnotes': ('components', 'footnotes'),
      'citations': ('components', 'citations'),
      'topic': ('components', 'topic'),
      'meta': ('html', 'meta'),
      'imagemap': ('html', 'imagemap'),
      'raw': ('misc', 'raw'),
      'restructuredtext-test-directive': ('misc', 'directive_test_function'),}
"""Mapping of directive name to (module name, function name). The directive
'name' is canonical & must be lowercase; language-dependent names are defined
in the language package."""

_modules = {}
"""Cache of imported directive modules."""

_directives = {}
"""Cache of imported directive functions."""

def directive(directivename, languagemodule):
    """
    Locate and return a directive function from its language-dependent name.
    """
    normname = directivename.lower()
    if _directives.has_key(normname):
        return _directives[normname]
    try:
        canonicalname = languagemodule.directives[normname]
        modulename, functionname = _directive_registry[canonicalname]
    except KeyError:
        return None
    if _modules.has_key(modulename):
        module = _modules[modulename]
    else:
        try:
            module = __import__(modulename, globals(), locals())
        except ImportError:
            return None
    try:
        function = getattr(module, functionname)
    except AttributeError:
        return None
    return function
@


1.8
log
@  - Added entryies for: components.py directives (contents,    footnotes, citations, topic), misc.py directives (raw).
@
text
@d6 2
a7 2
:Revision: $Revision: 1.7 $
:Date: $Date: 2002/02/12 02:29:02 $
d36 1
d68 3
@


1.7
log
@Added docstring, entries for "meta" & "imagemap"
@
text
@d6 2
a7 2
:Revision: $Revision: 1.6 $
:Date: $Date: 2001/11/06 00:53:24 $
a36 4
      'restructuredtext-test-directive': ('directivetest',
                                          'directive_test_function'),
      'image': ('images', 'image'),
      'figure': ('images', 'figure'),
d46 6
d53 3
a55 1
      'imagemap': ('html', 'imagemap'),}
@


1.6
log
@  - Added 'hint'.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.5 $
:Date: $Date: 2001/09/13 02:20:34 $
d11 19
d49 3
a51 1
      'warning': ('admonitions', 'warning'),}
@


1.5
log
@  - Added 'attention' admonition.  - Sorted admonitions alphabetically.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.4 $
:Date: $Date: 2001/09/12 04:02:18 $
d29 1
@


1.4
log
@  - Changed name of test directive function.  - Added 'error' directive'.  - Changed 'directive()' to return None instead of raise an    exception when no directive name/module/function is found.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.3 $
:Date: $Date: 2001/09/10 04:40:06 $
d22 5
d29 1
a29 5
      'warning': ('admonitions', 'warning'),
      'error': ('admonitions', 'error'),
      'caution': ('admonitions', 'caution'),
      'danger': ('admonitions', 'danger'),
      'important': ('admonitions', 'important'),}
@


1.3
log
@  - Added directive registry.  - Added directive module & function import support.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.2 $
:Date: $Date: 2001/08/23 04:11:57 $
d19 1
a19 1
                                          'test_directive_function'),
d25 1
d51 8
a58 2
        module = __import__(modulename, globals(), locals())
    function = getattr(module, functionname)
@


1.2
log
@updated
@
text
@d5 3
a7 3
:Contact: dgoodger@@bigfoot.com
:Revision: $Revision: 1.1.1.1 $
:Date: $Date: 2001/07/21 22:14:13 $
d10 1
d13 40
@


1.1
log
@Initial revision
@
text
@d4 5
a8 5
Author: David Goodger
Contact: dgoodger@@bigfoot.com
Revision: $Revision: 1.1 $
Date: $Date: 2001/07/20 00:35:35 $
Copyright: This module has been placed in the public domain.
@


1.1.1.1
log
@initial checkin
@
text
@@
