head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2002.04.18.02.53.21;	author goodger;	state Exp;
branches;
next	1.8;

1.8
date	2002.03.16.06.11.11;	author goodger;	state Exp;
branches;
next	1.7;

1.7
date	2002.01.16.02.43.13;	author goodger;	state Exp;
branches;
next	1.6;

1.6
date	2001.11.19.04.01.39;	author goodger;	state Exp;
branches;
next	1.5;

1.5
date	2001.11.06.01.07.59;	author goodger;	state Exp;
branches;
next	1.4;

1.4
date	2001.10.31.05.55.39;	author goodger;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.27.05.38.27;	author goodger;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.26.04.31.06;	author goodger;	state Exp;
branches;
next	1.1;

1.1
date	2001.10.20.03.04.37;	author goodger;	state Exp;
branches;
next	;


desc
@@


1.9
log
@fixed whitespace
@
text
@=============================
 DPS Document Tree Structure
=============================
:Author: David Goodger
:Contact: goodger@@users.sourceforge.net
:Revision: $Revision: 1.8 $
:Date: $Date: 2002/03/16 06:11:11 $

This document describes the internal data structure representing
document trees in the Python Docstring Processing System.  The data
structure is defined by the hierarchy of classes in the ``dps.nodes``
module.  It is also formally described by the `Generic Plaintext
Document Interface DTD`_ XML document type definition, gpdi.dtd_,
which is the definitive source for element hierarchy details.

Below is a simplified diagram of the hierarchy of element types in the
DPS document tree structure.  An element may contain any other
elements immediately below it in the diagram.  Note text is in square
brackets.  Element types in parentheses indicate recursive or
one-to-many relationships; sections may contain (sub)sections, tables
contain further body elements, etc. ::

  +--------------------------------------------------------------------+
  | document  [may begin with a title, subtitle, docinfo]              |
  |                             +--------------------------------------+
  |                             | sections  [each begins with a title] |
  +-----------------------------+-------------------------+------------+
  | [body elements:]                                      | (sections) |
  |         | - literal | - lists  |       | - hyperlink  +------------+
  |         |   blocks  | - tables |       |   targets    |
  | para-   | - doctest | - block  | foot- | - sub. defs  |
  | graphs  |   blocks  |   quotes | notes | - comments   |
  +---------+-----------+----------+-------+--------------+
  | [text]+ | [text]    | (body elements)  | [text]       |
  | (inline +-----------+------------------+--------------+
  | markup) |
  +---------+


-------------------
 Element Hierarchy
-------------------

A class hierarchy has been implemented in nodes.py where the position
of the element (the level at which it can occur) is significant.
E.G., Root, Structural, Body, Inline classes etc.  Certain
transformations will be easier because we can use isinstance() on
them.

The elements making up DPS document trees can be categorized into the
following groups:

- _`Root element`: document_

- _`Title elements`: title_, subtitle_

- _`Bibliographic elements`: docinfo_, author_, authors_,
  organization_, contact_, version_, revision_, status_, date_,
  copyright_

- _`Structural elements`: document_, section_, topic_, transition_

- _`Body elements`:

  - _`General body elements`: paragraph_, literal_block_,
    block_quote_, doctest_block_, table_, figure_, image_, footnote_

  - _`Lists`: bullet_list_, enumerated_list_, definition_list_,
    field_list_, option_list_

  - _`Admonitions`: note_, tip_, warning_, error_, caution_, danger_,
    important_

  - _`Special body elements`: target_, substitution_definition_,
    comment_, system_warning_

- _`Inline elements`: emphasis_, strong_, interpreted_, literal_,
  reference_, target_, footnote_reference_, substitution_reference_,
  image_, problematic_


``Node``
========


``Text``
========


``Element``
===========


``TextElement``
===============


-------------------
 Element Reference
-------------------

``document``
============
description

contents

External attributes
-------------------
`Common external attributes`_.


Internal attributes
-------------------
- `Common internal attributes`_.
- ``explicittargets``
- ``implicittargets``
- ``externaltargets``
- ``indirecttargets``
- ``refnames``
- ``anonymoustargets``
- ``anonymousrefs``
- ``autofootnotes``
- ``autofootnoterefs``
- ``reporter``


---------------------
 Attribute Reference
---------------------

External Attributes
===================

Through the `%basic.atts;`_ parameter entity, all elements share the
following _`common external attributes`: id_, name_, dupname_,
source_.


``anonymous``
-------------
The ``anonymous`` attribute


``auto``
--------
The ``auto`` attribute


``dupname``
-----------
The ``dupname`` attribute


``id``
------
The ``id`` attribute


``name``
--------
The ``name`` attribute


``refid``
---------
The ``refid`` attribute


``refname``
-----------
The ``refname`` attribute


``refuri``
----------
The ``refuri`` attribute


``source``
----------
The ``source`` attribute


``xml:space``
-------------
The ``xml:space`` attribute


Internal Attributes
===================

All element objects share the following _`common internal attributes`:
rawsource_, children_, attributes_, tagname_.


------------------------
 DTD Parameter Entities
------------------------

``%basic.atts;``
================
The ``%basic.atts;`` parameter entity lists attributes common to all
elements.  See `Common Attributes`_.


``%body.elements;``
===================
The ``%body.elements;`` parameter entity


``%inline.elements;``
====================
The ``%inline.elements;`` parameter entity


``%reference.atts;``
====================
The ``%reference.atts;`` parameter entity


``%structure.model;``
=====================
The ``%structure.model;`` parameter entity


``%text.model;``
================
The ``%text.model;`` parameter entity


--------------------------------
 Appendix: Miscellaneous Topics
--------------------------------

Representation of Horizontal Rules
==================================

Having added the "horizontal rule" construct to the reStructuredText_
spec, a decision had to be made as to how to reflect the construct in
the implementation of the document tree.  Given this source::

    Document
    ========

    Paragraph

    --------

    Paragraph

The horizontal rule indicates a "transition" (in prose terms) or the
start of a new "division".  Before implementation, the parsed document
tree would be::

    <document>
        <section name="document">
            <title>
                Document
            <paragraph>
                Paragraph
            --------               <--- error here
            <paragraph>
                Paragraph

There are several possibilities for the implementation.  Solution 3
was chosen.

1. Implement horizontal rules as "divisions" or segments.  A
   "division" is a title-less, non-hierarchical section.  The first
   try at an implementation looked like this::

       <document>
           <section name="document">
               <title>
                   Document
               <paragraph>
                   Paragraph
               <division>
                   <paragraph>
                       Paragraph

   But the two paragraphs are really at the same level; they shouldn't
   appear to be at different levels.  There's really an invisible
   "first division".  The horizontal rule splits the document body
   into two segments, which should be treated uniformly.

2. Treating "divisions" uniformly brings us to the second
   possibility::

       <document>
           <section name="document">
               <title>
                   Document
               <division>
                   <paragraph>
                       Paragraph
               <division>
                   <paragraph>
                       Paragraph

   With this change, documents and sections will directly contain
   divisions and sections, but not body elements.  Only divisions will
   directly contain body elements.  Even without a horizontal rule
   anywhere, the body elements of a document or section would be
   contained within a division element.  This makes the document tree
   deeper.  This is similar to the way HTML treats document contents:
   grouped within a <BODY> element.

3. Implement them as "transitions", empty elements::

       <document>
           <section name="document">
               <title>
                   Document
               <paragraph>
                   Paragraph
               <transition>
               <paragraph>
                   Paragraph

   A transition would be a "point element", not containing anything,
   only identifying a point within the document structure.  This keeps
   the document tree flatter, but the idea of a "point element" like
   "transition" smells bad.  A transition isn't a thing itself, it's
   the space between two divisions.

   This solution has been chosen for incorporation into the document
   tree.


.. _Generic Plaintext Document Interface DTD:
.. _gpdi.dtd: http://docstring.sourceforge.net/spec/gpdi.dtd
.. _reStructuredText:
    http://structuredtext.sourceforge.net/spec/reStructuredText.txt


..
   Local Variables:
   mode: indented-text
   indent-tabs-mode: nil
   sentence-end-double-space: t
   fill-column: 70
   End:
@


1.8
log
@updated
@
text
@d6 2
a7 2
:Revision: $Revision: 1.7 $
:Date: $Date: 2002/01/16 02:43:13 $
d10 1
a10 1
document trees in the Python Docstring Processing System. The data
d12 1
a12 1
module. It is also formally described by the `Generic Plaintext
d17 5
a21 5
DPS document tree structure. An element may contain any other elements
immediately below it in the diagram. Note text is in square brackets.
Element types in parentheses indicate recursive or one-to-many
relationships; sections may contain (sub)sections, tables contain
further body elements, etc. ::
d45 4
a48 3
of the element (the level at which it can occur) is significant. E.G.,
Root, Structural, Body, Inline classes etc. Certain transformations
will be easier because we can use isinstance() on them.
d204 1
a204 1
elements. See `Common Attributes`_.
d241 1
a241 1
the implementation of the document tree. Given this source::
d253 1
a253 1
start of a new "division". Before implementation, the parsed document
d266 1
a266 1
There are several possibilities for the implementation. Solution 3
d269 3
a271 3
1. Implement horizontal rules as "divisions" or segments. A "division"
   is a title-less, non-hierarchical section. The first try at an
   implementation looked like this::
d284 3
a286 3
   appear to be at different levels. There's really an invisible
   "first division". The horizontal rule splits the document body into
   two segments, which should be treated uniformly.
d303 2
a304 2
   divisions and sections, but not body elements. Only divisions will
   directly contain body elements. Even without a horizontal rule
d306 2
a307 2
   contained within a division element. This makes the document tree
   deeper. This is similar to the way HTML treats document contents:
d323 1
a323 1
   only identifying a point within the document structure. This keeps
d325 1
a325 1
   "transition" smells bad. A transition isn't a thing itself, it's
@


1.7
log
@updated
@
text
@d6 2
a7 2
:Revision: $Revision: 1.6 $
:Date: $Date: 2001/11/19 04:01:39 $
d58 1
a58 1
  copyright_, abstract_
d60 1
a60 1
- _`Structural elements`: section_, transition_
d78 1
a78 1
  image_
d217 1
a217 1
===============
@


1.6
log
@  - Removed generic 'directive'.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.5 $
:Date: $Date: 2001/11/06 01:07:59 $
d124 1
a124 1
- ``errorhandler``
@


1.5
log
@updated
@
text
@d6 2
a7 2
:Revision: $Revision: 1.4 $
:Date: $Date: 2001/10/31 05:55:39 $
d31 1
a31 1
  | para-   | - doctest | - block  | foot- | - directives |
d73 1
a73 1
  - _`Special body elements`: target_, directive_, substitution_
@


1.4
log
@  - Changed "link" to "reference".
@
text
@d6 2
a7 2
:Revision: $Revision: 1.3 $
:Date: $Date: 2001/10/27 05:38:27 $
d11 4
a14 4
structure is defined by classes in the ``dps.nodes`` module. It is
also formally described by the `Generic Plaintext Document Interface
DTD`_ XML document type definition, gpdi.dtd_, which is the definitive
source for element hierarchy details.
d41 1
a41 1
 Element Reference
d44 5
d73 2
a74 2
  - _`Special body elements`: target_, directive_, comment_,
    system_warning_
d77 7
a83 1
  reference_, target_, footnote_reference_, image_
d85 15
d265 1
a265 1
There are several possibilities for the implementation. Solution #2
a308 2
   This solution has been chosen.

d326 3
@


1.3
log
@minor mods
@
text
@d6 2
a7 2
:Revision: $Revision: 1.2 $
:Date: $Date: 2001/10/26 04:31:06 $
d72 1
a72 1
  link_, target_, footnote_reference_, image_
d190 1
a190 1
``%link.atts;``
d192 1
a192 1
The ``%link.atts;`` parameter entity
@


1.2
log
@Added outline of reference text.
@
text
@d6 2
a7 2
:Revision: $Revision: 1.1 $
:Date: $Date: 2001/10/20 03:04:37 $
d28 2
a29 4
  | divisions                                             | (sections) |
  +-------------------------------------------------------+------------+
  | [body elements:]                                      |
  |         | - literal | - lists  |       | - hyperlink  |
d55 1
a55 1
- _`Structural elements`: section_
d60 1
a60 1
    block_quote_, doctest_block_, table_, figure_, footnote_
d72 1
a72 1
  link_, footnote_reference_, image_
d115 1
a115 1
The ``anonymous`` attribute 
d120 1
a120 1
The ``auto`` attribute 
d125 1
a125 1
The ``dupname`` attribute 
d130 1
a130 1
The ``id`` attribute 
d135 1
a135 1
The ``name`` attribute 
d140 1
a140 1
The ``refid`` attribute 
d145 1
a145 1
The ``refname`` attribute 
d150 1
a150 1
The ``refuri`` attribute 
d155 1
a155 1
The ``source`` attribute 
d160 1
a160 1
The ``xml:space`` attribute 
d182 1
a182 1
The ``%body.elements;`` parameter entity 
d187 1
a187 1
The ``%inline.elements;`` parameter entity 
d192 1
a192 1
The ``%link.atts;`` parameter entity 
d197 1
a197 1
The ``%structure.model;`` parameter entity 
d202 1
a202 1
The ``%text.model;`` parameter entity 
d260 1
a260 1
   
d282 1
a282 1
   
d302 1
a302 1
   
@


1.1
log
@DPS Document Tree Structure
@
text
@d6 2
a7 2
:Revision: $Revision$
:Date: $Date$
d41 169
@

